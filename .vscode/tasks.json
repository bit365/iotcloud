{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Start Docker Compose",
            "type": "shell",
            "command": "docker",
            "args": [
                "compose",
                "-f",
                "${workspaceFolder}/scripts/docker-compose.yaml",
                "up",
                "-d"
            ],
            "options": {
                "cwd": "${workspaceFolder}/scripts",
            },
            "problemMatcher": []
        },
        {
            "label": "Stop Docker Compose",
            "type": "shell",
            "command": "docker",
            "args": [
                "compose",
                "-f",
                "${workspaceFolder}/scripts/docker-compose.yaml",
                "down"
            ],
            "options": {
                "cwd": "${workspaceFolder}/scripts",
            },
            "problemMatcher": []
        },
        {
            "label": "Install Golang Migrate Tool",
            "type": "shell",
            "command": "go",
            "args": [
                "install",
                "-tags",
                "postgres",
                "github.com/golang-migrate/migrate/v4/cmd/migrate@latest"
            ],
            "problemMatcher": []
        },
        {
            "label": "Apply Database Migrations (Up)",
            "type": "shell",
            "command": "migrate",
            "args": [
                "-path",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "-database",
                "postgres://postgres:password@localhost:5432/postgres?sslmode=disable",
                "up"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/webapi"
            },
            "problemMatcher": []
        },
        {
            "label": "Revert Database Migrations (Down)",
            "type": "shell",
            "command": "migrate",
            "args": [
                "-path",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "-database",
                "postgres://postgres:password@localhost:5432/postgres?sslmode=disable",
                "down"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/webapi"
            },
            "problemMatcher": []
        },
        {
            "label": "Force Database Migration Version",
            "type": "shell",
            "command": "migrate",
            "args": [
                "-path",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "-database",
                "postgres://postgres:password@localhost:5432/postgres?sslmode=disable",
                "force",
                "1"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/webapi"
            },
            "problemMatcher": []
        },
        {
            "label": "Create New Database Migration",
            "type": "shell",
            "command": "migrate",
            "args": [
                "-path",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "-database",
                "postgres://postgres:password@localhost:5432/postgres?sslmode=disable",
                "create",
                "-ext",
                "sql",
                "-dir",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "${input:migrationName}"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/webapi"
            },
            "problemMatcher": []
        },
        {
            "label": "Redo Last Database Migration",
            "type": "shell",
            "command": "migrate",
            "args": [
                "-path",
                "${workspaceFolder}/services/webapi/internal/database/migrations",
                "-database",
                "postgres://postgres:password@localhost:5432/postgres?sslmode=disable",
                "redo"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/webapi"
            },
            "problemMatcher": []
        },
    ]
}